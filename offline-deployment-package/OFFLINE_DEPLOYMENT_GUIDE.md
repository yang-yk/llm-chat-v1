# LLM Chat ç¦»çº¿éƒ¨ç½²æŒ‡å— v2.0

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•åœ¨æ— ç½‘ç»œç¯å¢ƒä¸‹éƒ¨ç½² LLM Chat ç³»ç»Ÿï¼Œæ”¯æŒçµæ´»é…ç½® IP åœ°å€å’Œç«¯å£ã€‚

## ğŸ“‹ ç›®å½•

- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å‡†å¤‡å·¥ä½œ](#å‡†å¤‡å·¥ä½œ)
- [éƒ¨ç½²æ­¥éª¤](#éƒ¨ç½²æ­¥éª¤)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [å¸¸ç”¨å‘½ä»¤](#å¸¸ç”¨å‘½ä»¤)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ğŸ”§ ç¯å¢ƒè¦æ±‚

### ç¡¬ä»¶è¦æ±‚
- **CPU**: 2æ ¸æˆ–ä»¥ä¸Š
- **å†…å­˜**: 4GB æˆ–ä»¥ä¸Š
- **ç£ç›˜**: è‡³å°‘ 5GB å¯ç”¨ç©ºé—´

### è½¯ä»¶è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Linux (æ¨è Ubuntu 20.04+, CentOS 7+)
- **Docker**: 20.10+ ç‰ˆæœ¬
- **Docker Compose**: 2.0+ ç‰ˆæœ¬

## ğŸ“¦ å‡†å¤‡å·¥ä½œ

### 1. ç”Ÿæˆç¦»çº¿éƒ¨ç½²åŒ…ï¼ˆåœ¨æœ‰ç½‘ç»œçš„ç¯å¢ƒï¼‰

åœ¨æºæœåŠ¡å™¨ä¸Šè¿è¡Œæ‰“åŒ…è„šæœ¬ï¼š

```bash
cd /home/data2/yangyk/llm-chat-v1
bash create-offline-package.sh
```

è¿™å°†ç”Ÿæˆä¸€ä¸ªåŒ…å«ä»¥ä¸‹æ–‡ä»¶çš„å‹ç¼©åŒ…ï¼š
- `project-source.tar.gz` - é¡¹ç›®æºç 
- `llm-chat-images.tar` - Docker é•œåƒ
- `offline-deploy.sh` - éƒ¨ç½²è„šæœ¬
- `OFFLINE_DEPLOYMENT_GUIDE.md` - æœ¬æ–‡æ¡£
- `README.txt`, `QUICK_START.txt` - è¯´æ˜æ–‡æ¡£

### 2. ä¼ è¾“æ–‡ä»¶åˆ°ç›®æ ‡æœåŠ¡å™¨

ä½¿ç”¨ U ç›˜ã€ç½‘ç»œä¼ è¾“ç­‰æ–¹å¼å°†å‹ç¼©åŒ…ä¼ è¾“åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

### 3. è§£å‹æ–‡ä»¶

```bash
tar xzf llm-chat-offline-XXXXXX.tar.gz
cd offline-deployment-package
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: å®‰è£… Dockerï¼ˆå¦‚å·²å®‰è£…å¯è·³è¿‡ï¼‰

#### åœ¨çº¿å®‰è£…ï¼ˆå¦‚æœ‰ç½‘ç»œï¼‰

```bash
# Ubuntu/Debian
curl -fsSL https://get.docker.com | bash
sudo usermod -aG docker $USER

# å¯åŠ¨ Docker
sudo systemctl start docker
sudo systemctl enable docker
```

### æ­¥éª¤ 2: è¿è¡Œéƒ¨ç½²è„šæœ¬

```bash
bash offline-deploy.sh
```

### æ­¥éª¤ 3: é…ç½®éƒ¨ç½²å‚æ•°

è„šæœ¬ä¼šäº¤äº’å¼åœ°è¯¢é—®é…ç½®ä¿¡æ¯ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ | é»˜è®¤å€¼ |
|--------|------|------|--------|
| æœåŠ¡å™¨åœ°å€ | ç”¨æˆ·è®¿é—®çš„IP/åŸŸå | 192.168.1.100 | å¿…å¡« |
| Nginx ç«¯å£ | ä¸»å…¥å£ç«¯å£ | 80 | 80 |
| å‰ç«¯ç«¯å£ | Next.js ç«¯å£ | 3000 | 3000 |
| åç«¯ç«¯å£ | FastAPI ç«¯å£ | 8000 | 8000 |
| éƒ¨ç½²ç›®å½• | é¡¹ç›®å®‰è£…ä½ç½® | /opt/llm-chat | /opt/llm-chat |
| æ¨¡å‹ API åœ°å€ | LLM æœåŠ¡åœ°å€ | http://127.0.0.1:11553/... | (è§è„šæœ¬) |
| æ¨¡å‹åç§° | æ¨¡å‹æ ‡è¯† | glm4_32B_chat | glm4_32B_chat |
| API Key | æ¨¡å‹å¯†é’¥ | glm432b | glm432b |
| ç®¡ç†å‘˜ç”¨æˆ·å | åˆå§‹ç®¡ç†å‘˜è´¦å· | admin | admin |
| ç®¡ç†å‘˜å¯†ç  | åˆå§‹å¯†ç  | - | Admin@2025 |

### æ­¥éª¤ 4: ç­‰å¾…éƒ¨ç½²å®Œæˆ

éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨å®Œæˆï¼š
1. âœ“ è§£å‹é¡¹ç›®æºç 
2. âœ“ åŠ è½½ Docker é•œåƒ
3. âœ“ ç”Ÿæˆé…ç½®æ–‡ä»¶
4. âœ“ å¯åŠ¨ Docker å®¹å™¨
5. âœ“ åˆ›å»ºç®¡ç†å‘˜è´¦å·

### æ­¥éª¤ 5: è®¿é—®æœåŠ¡

```
ä¸»é¡µ: http://æ‚¨çš„IP:80
ç®¡ç†åå°: http://æ‚¨çš„IP:80/admin
```

## âš™ï¸ é…ç½®è¯´æ˜

### é…ç½®æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| Docker Compose | `/opt/llm-chat/docker-compose.yml` | æœåŠ¡é…ç½® |
| Nginx é…ç½® | `/opt/llm-chat/nginx/default.conf` | åå‘ä»£ç† |
| å‰ç«¯ç¯å¢ƒå˜é‡ | `/opt/llm-chat/frontend/.env.local` | å‰ç«¯é…ç½® |
| éƒ¨ç½²ä¿¡æ¯ | `/opt/llm-chat/deployment-info.txt` | éƒ¨ç½²è®°å½• |

### ä¿®æ”¹é…ç½®åé‡å¯

```bash
cd /opt/llm-chat
docker compose restart
```

## ğŸ“ å¸¸ç”¨å‘½ä»¤

```bash
# è¿›å…¥éƒ¨ç½²ç›®å½•
cd /opt/llm-chat

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f

# é‡å¯æœåŠ¡
docker compose restart

# åœæ­¢æœåŠ¡
docker compose down

# å¯åŠ¨æœåŠ¡
docker compose up -d

# å¤‡ä»½æ•°æ®åº“
docker compose exec backend cp /app/db/conversation.db /tmp/backup.db
docker compose cp backend:/tmp/backup.db ./backup-$(date +%Y%m%d).db
```

## ğŸ› æ•…éšœæ’æŸ¥

### å®¹å™¨æ— æ³•å¯åŠ¨

```bash
# æŸ¥çœ‹æ—¥å¿—
docker compose logs backend
docker compose logs frontend

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep -E '80|3000|8000'
```

### æ— æ³•è®¿é—®æœåŠ¡

```bash
# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status
sudo ufw allow 80/tcp

# æµ‹è¯•ç«¯å£
curl http://localhost:80
```

### å‰ç«¯æ— æ³•è¿æ¥åç«¯

```bash
# æ£€æŸ¥é…ç½®
cat docker-compose.yml | grep -A 5 frontend
cat nginx/default.conf
```

## â“ å¸¸è§é—®é¢˜

**Q: å¯ä»¥ä¿®æ”¹ç«¯å£å—ï¼Ÿ**
A: å¯ä»¥ï¼Œåœ¨éƒ¨ç½²æ—¶è¾“å…¥è‡ªå®šä¹‰ç«¯å£ï¼Œæˆ–ä¿®æ”¹é…ç½®æ–‡ä»¶åé‡å¯ã€‚

**Q: æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ**
A: Docker volume ä¸­ï¼Œä½¿ç”¨å¤‡ä»½å‘½ä»¤å¯¼å‡ºã€‚

**Q: å¦‚ä½•å‡çº§ï¼Ÿ**
A: å¤‡ä»½æ•°æ® â†’ åŠ è½½æ–°é•œåƒ â†’ é‡å¯æœåŠ¡ã€‚

**Q: æ”¯æŒ HTTPS å—ï¼Ÿ**
A: éœ€è¦é…ç½® SSL è¯ä¹¦åˆ° Nginxã€‚

## ğŸ—ï¸ ç½‘ç»œæ¶æ„

```
ç”¨æˆ· â†’ Nginx:80 â†’ å‰ç«¯:3000 â”
                 â†“           â†“
              åç«¯:8000 â†’ LLMæ¨¡å‹
```

## ğŸ”’ å®‰å…¨å»ºè®®

1. ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
2. é…ç½®é˜²ç«å¢™è§„åˆ™
3. å®šæœŸå¤‡ä»½æ•°æ®åº“
4. ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HTTPS
5. å®šæœŸæ£€æŸ¥æ—¥å¿—

## ğŸ“š æ›´å¤šä¿¡æ¯

- å®Œæ•´æ–‡æ¡£: `README.md`
- å¿«é€Ÿå‚è€ƒ: `QUICK_REFERENCE.md`
- æ•…éšœæ’æŸ¥: `TROUBLESHOOTING_FAILED_TO_FETCH.md`

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**æ›´æ–°æ—¶é—´**: 2025-10-05
**é¡¹ç›®åœ°å€**: /home/data2/yangyk/llm-chat-v1
